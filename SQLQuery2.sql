create table TOTALS (
SALARY INT,
EXPECTED INT,
);

DROP TABLE TOTALS

insert into TOTALS 
VALUES 
(1000,1000),
(2000,3000),
(3000,6000),
(4000,10000),
(5000,15000),
(8000,23000);

select *,
sum(SALARY) over (order by SALARY asc)
as EXPECTED
from TOTALS

ALTER TABLE TOTALS 
ADD DEPT VARCHAR(300);

UPDATE TOTALS 
SET DEPT = 'FINANCE'
WHERE SALARY = 8000;


SELECT 
SUM(SALARY), DEPT FROM TOTALS 
GROUP BY 
ROLLUP(DEPT);

SELECT * FROM TOTALS

SELECT SALARY, 
CASE
WHEN DEPT IS NULL THEN 'TOTAL'
ELSE DEPT
END 
 AS DEPT
 FROM
(
SELECT 
SUM(SALARY) AS salary,
DEPT
FROM TOTALS 
GROUP BY 
ROLLUP(DEPT)
) AS A;

select SALARY, 
case when DEPT is null 
THEN 'TOTAL' 
else DEPT 
END 
as DEPT  
from
(
SELECT 
SUM(SALARY)AS salary,
DEPT
FROM TOTALS 
GROUP BY 
ROLLUP(DEPT)
) as t;









